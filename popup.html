<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fiyat TakipÃ§isi Pro</title>
  <link rel="stylesheet" href="m3-tokens.css" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Header -->
  <div class="header">
    <div class="header-top">
      <div class="logo">
        <div class="logo-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
            <line x1="7" y1="7" x2="7.01" y2="7"></line>
          </svg>
        </div>
        <span>Fiyat TakipÃ§isi</span>
      </div>
      <div class="header-actions">
        <button class="icon-btn" id="themeToggle" title="Tema DeÄŸiÅŸtir" aria-label="Tema DeÄŸiÅŸtir">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
        <button class="icon-btn" id="debugBtn" title="Debug Konsolu" aria-label="Debug Konsolu">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
            <line x1="8" y1="21" x2="16" y2="21"></line>
            <line x1="12" y1="17" x2="12" y2="21"></line>
          </svg>
        </button>
        <button class="icon-btn" id="settingsBtn" title="Ayarlar" aria-label="Ayarlar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M12 1v6m0 6v6m5.2-13.8l-4.2 4.2m-1.4 1.4l-4.2 4.2M23 12h-6m-6 0H1m18.8-5.2l-4.2 4.2m-1.4 1.4l-4.2 4.2">
            </path>
          </svg>
        </button>
      </div>
    </div>

    <div class="stats-mini">
      <div class="stat-mini">
        <div class="stat-mini-value" id="totalProducts">0</div>
        <div class="stat-mini-label">ÃœrÃ¼n</div>
      </div>
      <div class="stat-mini">
        <div class="stat-mini-value" id="totalSavings">0â‚º</div>
        <div class="stat-mini-label">Tasarruf</div>
      </div>
      <div class="stat-mini">
        <div class="stat-mini-value" id="lastCheck">-</div>
        <div class="stat-mini-label">Son</div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs" role="tablist">
    <button class="tab active" data-tab="home" role="tab" aria-selected="true">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
      <span>Ana Sayfa</span>
    </button>
    <button class="tab" data-tab="list" role="tab" aria-selected="false">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <line x1="3" y1="6" x2="3.01" y2="6"></line>
        <line x1="3" y1="12" x2="3.01" y2="12"></line>
        <line x1="3" y1="18" x2="3.01" y2="18"></line>
      </svg>
      <span>Liste</span>
    </button>
    <button class="tab" data-tab="alerts" role="tab" aria-selected="false">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <span>Alarmlar</span>
    </button>
  </div>

  <!-- Content -->
  <div class="content">
    <!-- Home Tab -->
    <div class="tab-content active" id="homeTab">
      <!-- Loading State -->
      <div id="loadingState" style="display: none">
        <div class="loading-card">
          <div class="skeleton skeleton-title"></div>
          <div class="skeleton skeleton-price"></div>
          <div class="skeleton skeleton-text"></div>
        </div>
      </div>

      <!-- Product Detected -->
      <div id="productDetected" style="display: none">
        <div class="product-detect-card">
          <div class="detect-header">
            <div class="detect-status">
              <div class="pulse-dot"></div>
              <span>ÃœrÃ¼n AlgÄ±landÄ±</span>
            </div>
            <div class="site-tag" id="detectedSite"></div>
          </div>
          <div class="product-name-large" id="detectedName"></div>
          <div class="price-display">
            <div class="price-large" id="detectedPrice"></div>
            <div class="confidence-pill" id="detectedConfidence"></div>
          </div>
          <button class="btn-add-product" id="addProductBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            <span>Takibe Al</span>
          </button>
        </div>

        <div class="quick-actions">
          <button class="quick-action-btn" id="refreshAllBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23 4 23 10 17 10"></polyline>
              <polyline points="1 20 1 14 7 14"></polyline>
              <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
            <span>Hepsini Kontrol</span>
          </button>
          <button class="quick-action-btn" id="openSiteBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
              <polyline points="15 3 21 3 21 9"></polyline>
              <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
            <span>Sitede AÃ§</span>
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div id="emptyState">
        <div class="empty-state">
          <div class="empty-icon">ğŸ”</div>
          <div class="empty-title">ÃœrÃ¼n BulunamadÄ±</div>
          <div class="empty-text">
            Bir e-ticaret sitesindeki Ã¼rÃ¼n sayfasÄ±na gidin ve fiyat takibine
            baÅŸlayÄ±n
          </div>
          <button class="btn-manual-select" id="manualSelectBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 11l3 3L22 4"></path>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
            <span>Manuel SeÃ§</span>
          </button>
        </div>
      </div>
    </div>

    <!-- List Tab -->
    <div class="tab-content" id="listTab">
      <div class="search-bar">
        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" class="search-input" id="searchInput" placeholder="ÃœrÃ¼n veya site ara..."
          aria-label="ÃœrÃ¼n ara" />
        <button class="clear-search" id="clearSearch" aria-label="AramayÄ± temizle">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <div class="product-list" id="productList">
        <!-- Products will be inserted here -->
      </div>

      <div id="listEmptyState" style="display: none">
        <div class="empty-state">
          <div class="empty-icon">ğŸ“¦</div>
          <div class="empty-title">HenÃ¼z ÃœrÃ¼n Yok</div>
          <div class="empty-text">Ana sayfadan Ã¼rÃ¼n ekleyerek baÅŸlayÄ±n</div>
        </div>
      </div>
    </div>

    <!-- Alerts Tab - Full M3 Pattern -->
    <div class="tab-content" id="alertsTab">
      <!-- Selection Mode Top Bar -->
      <div class="selection-top-bar">
        <button class="btn-icon" id="cancelSelectionBtn" title="Ä°ptal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
        <span class="selection-count" id="selectionCount">0 seÃ§ili</span>
        <div class="selection-actions">
          <button class="btn btn-tonal btn-sm" id="pauseSelectedBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="6" y="4" width="4" height="16"></rect>
              <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
            Duraklat
          </button>
          <button class="btn btn-danger btn-sm" id="deleteSelectedBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
            </svg>
            Sil
          </button>
        </div>
      </div>

      <!-- Normal Header -->
      <div class="alerts-header" id="alertsHeader">
        <h3 class="alerts-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          Fiyat AlarmlarÄ±
        </h3>
        <span class="badge info" id="alertsBadge">0</span>
      </div>

      <!-- Alerts List Container -->
      <div class="alerts-list" id="alertsList">
        <!-- M3 Alarm cards will be inserted here -->
      </div>

      <!-- Enhanced Empty State -->
      <div id="alertsEmptyState">
        <div class="empty-state m3-empty-state">
          <div class="empty-illustration">
            <div class="empty-icon-bg">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                <line x1="12" y1="2" x2="12" y2="4"></line>
              </svg>
            </div>
          </div>
          <div class="empty-title">HenÃ¼z Alarm Yok</div>
          <div class="empty-text">
            Takip ettiÄŸiniz Ã¼rÃ¼nler iÃ§in fiyat alarmlarÄ± oluÅŸturun.<br>
            Hedef fiyata ulaÅŸÄ±ldÄ±ÄŸÄ±nda bildirim alacaksÄ±nÄ±z.
          </div>
          <button class="btn btn-filled" id="emptyStateAddBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Ä°lk AlarmÄ± OluÅŸtur
          </button>
        </div>
      </div>

      <!-- M3 FAB - Floating Action Button -->
      <div class="m3-fab" id="alertsFab">
        <button class="fab-button extended" id="fabAddAlert">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          <span class="fab-label">Yeni Alarm</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Add Alert Modal - Enhanced M3 -->
  <div class="modal" id="addAlertModal" style="display: none;">
    <div class="modal-backdrop" id="alertModalBackdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title-group">
          <span class="modal-icon">ğŸ””</span>
          <h3>Fiyat AlarmÄ± OluÅŸtur</h3>
        </div>
        <button class="modal-close" id="closeAlertModal" aria-label="Kapat">Ã—</button>
      </div>

      <div class="modal-body">
        <!-- Product Selection -->
        <div class="form-group">
          <label class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            ÃœrÃ¼n SeÃ§in
          </label>
          <select id="alertProductSelect" class="form-select">
            <option value="">Bir Ã¼rÃ¼n seÃ§in...</option>
          </select>
          <div class="product-info-card" id="selectedProductInfo" style="display: none;">
            <div class="product-info-name" id="selectedProductName">-</div>
            <div class="product-info-price">
              <span class="label">Mevcut Fiyat:</span>
              <span class="value" id="selectedProductPrice">-</span>
            </div>
          </div>
        </div>

        <!-- Alarm Type Selection -->
        <div class="form-group">
          <label class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M12 6v6l4 2"></path>
            </svg>
            Alarm TÃ¼rÃ¼
          </label>
          <div class="alarm-type-cards" id="alarmTypeCards">
            <div class="alarm-type-card selected" data-type="target_price">
              <div class="alarm-type-icon">ğŸ¯</div>
              <div class="alarm-type-name">Hedef Fiyat</div>
              <div class="alarm-type-desc">Belirli fiyata dÃ¼ÅŸÃ¼nce</div>
            </div>
            <div class="alarm-type-card" data-type="percentage_drop">
              <div class="alarm-type-icon">ğŸ“‰</div>
              <div class="alarm-type-name">YÃ¼zde DÃ¼ÅŸÃ¼ÅŸ</div>
              <div class="alarm-type-desc">%X kadar dÃ¼ÅŸÃ¼nce</div>
            </div>
            <div class="alarm-type-card" data-type="percentage_rise">
              <div class="alarm-type-icon">ğŸ“ˆ</div>
              <div class="alarm-type-name">YÃ¼zde ArtÄ±ÅŸ</div>
              <div class="alarm-type-desc">%X kadar artÄ±nca</div>
            </div>
            <div class="alarm-type-card" data-type="any_change">
              <div class="alarm-type-icon">ğŸ”„</div>
              <div class="alarm-type-name">Herhangi DeÄŸiÅŸiklik</div>
              <div class="alarm-type-desc">Fiyat deÄŸiÅŸince</div>
            </div>
          </div>
        </div>

        <!-- Target Price Input -->
        <div class="form-group" id="targetPriceGroup">
          <label class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
            Hedef Fiyat
          </label>
          <div class="input-with-suffix">
            <input type="number" id="alertTargetPrice" placeholder="Ã–rn: 1500" step="0.01" min="0">
            <span class="input-suffix">â‚º</span>
          </div>
          <div class="form-hint" id="priceHint">Fiyat bu deÄŸere dÃ¼ÅŸÃ¼nce bildirim alacaksÄ±nÄ±z</div>
        </div>

        <!-- Target Percent Input -->
        <div class="form-group" id="targetPercentGroup" style="display: none;">
          <label class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="19" y1="5" x2="5" y2="19"></line>
              <circle cx="6.5" cy="6.5" r="2.5"></circle>
              <circle cx="17.5" cy="17.5" r="2.5"></circle>
            </svg>
            DeÄŸiÅŸim OranÄ±
          </label>
          <div class="input-with-suffix">
            <input type="number" id="alertTargetPercent" placeholder="Ã–rn: 10" min="1" max="99" value="10">
            <span class="input-suffix">%</span>
          </div>
          <div class="form-hint" id="percentHint">Fiyat %10 dÃ¼ÅŸÃ¼nce bildirim alacaksÄ±nÄ±z</div>
        </div>

        <!-- Notification Options -->
        <div class="form-group">
          <label class="form-label">Bildirim SeÃ§enekleri</label>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" id="alertNotifyBrowser" checked>
              <span class="checkbox-mark"></span>
              <span>TarayÄ±cÄ± bildirimi gÃ¶nder</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="alertOneTime" checked>
              <span class="checkbox-mark"></span>
              <span>Tek seferlik (tetiklendikten sonra sil)</span>
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-text" id="cancelAlertBtn">Ä°ptal</button>
        <button class="btn btn-primary" id="saveAlertBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
          </svg>
          Alarm OluÅŸtur
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast" role="alert" aria-live="polite">
    <span class="toast-icon" id="toastIcon"></span>
    <span id="toastMessage"></span>
  </div>

  <!-- M3 Bottom Sheet - Alarm Details -->
  <div class="m3-bottom-sheet" id="alarmBottomSheet">
    <div class="bottom-sheet-scrim" id="bottomSheetScrim"></div>
    <div class="bottom-sheet-container">
      <div class="bottom-sheet-drag-handle"></div>
      <div class="bottom-sheet-header">
        <h3 class="bottom-sheet-title" id="bottomSheetTitle">Alarm DetaylarÄ±</h3>
      </div>
      <div class="bottom-sheet-content" id="bottomSheetContent">
        <!-- Dynamic content will be inserted here -->
      </div>
      <div class="bottom-sheet-actions">
        <button class="btn btn-text" id="bottomSheetEdit">DÃ¼zenle</button>
        <button class="btn btn-tonal" id="bottomSheetPause">Duraklat</button>
        <button class="btn btn-danger" id="bottomSheetDelete">Sil</button>
      </div>
    </div>
  </div>

  <!-- M3 Snackbar - Confirmations -->
  <div class="m3-snackbar" id="snackbar">
    <span class="snackbar-message" id="snackbarMessage">Ä°ÅŸlem tamamlandÄ±</span>
    <button class="snackbar-action" id="snackbarAction">Geri Al</button>
  </div>

  <!-- Load all required libraries in correct order -->
  <script src="lib/config.js"></script>
  <script src="lib/errors.js"></script>
  <script src="lib/validators.js"></script>
  <script src="lib/cache.js"></script>
  <script src="lib/messaging.js"></script>
  <script src="lib/helpers.js"></script>
  <script src="lib/sites.js"></script>
  <script src="lib/parser.js"></script>
  <script src="lib/alerts.js"></script>
  <script src="lib/data-manager.js"></script>
  <script src="popup.js"></script>
</body>

</html>